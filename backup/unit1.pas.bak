Unit Unit1;

{$mode objfpc}{$H+}

Interface

Uses
  Classes, SysUtils, FileUtil, Forms, Controls, Graphics, Dialogs, Menus,
  ExtCtrls, StdCtrls, Unit2;

Type

  { TForm1 }

  TForm1 = Class(TForm)
    CheckBox1: TCheckBox;
    Label1: TLabel;
    Label2: TLabel;
    Label3: TLabel;
    Label4: TLabel;
    Label5: TLabel;
    Label6: TLabel;
    MainMenu1: TMainMenu;
    MenuItem1: TMenuItem;
    MenuItem10: TMenuItem;
    MenuItem2: TMenuItem;
    MenuItem3: TMenuItem;
    MenuItem4: TMenuItem;
    MenuItem6: TMenuItem;
    MenuItem7: TMenuItem;
    MenuItem8: TMenuItem;
    MenuItem9: TMenuItem;
    PaintBox1: TPaintBox;
    Timer1: TTimer;
    Procedure CheckBox1Change(Sender: TObject);
    Procedure FormCreate(Sender: TObject);
    Procedure MenuItem10Click(Sender: TObject);
    Procedure MenuItem2Click(Sender: TObject);
    Procedure MenuItem5Click(Sender: TObject);
    Procedure PaintBox1MouseDown(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    Procedure PaintBox1Paint(Sender: TObject);
    Procedure Timer1Timer(Sender: TObject);

  Private
    Seconds, flags: Integer;
    { private declarations }
  Public
    { public declarations }
  End;

Var
  Form1: TForm1;

Implementation

{$R *.lfm}

{ TForm1 }

Procedure TForm1.MenuItem2Click(Sender: TObject);
Begin
  Application.Terminate;
End;

Procedure TForm1.MenuItem5Click(Sender: TObject);
Begin

End;

Procedure TForm1.PaintBox1MouseDown(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
Var
  bmFlag: Tbitmap;
  i, j, n, p: Integer;
Begin
  bmFlag := TBitmap.Create;
  bmFlag.LoadFromFile('bomb.bmp');
  i := x Div 50;
  j := y Div 50;
  n := 50 * i;
  p := 50 * j;
  If (ssRight In Shift) And (flags > 0) Then
  Begin
    If Label5.Visible = True Then
    Begin
      Timer1.Enabled := True;
    End;
    CheckBox1.Visible := False;
    PaintBox1.Canvas.Draw(n, p, bmFlag);
    bmFlag.Free;
    flags := flags - 1;
    Label4.Caption := IntToStr(flags);
  End;
End;

Procedure TForm1.FormCreate(Sender: TObject);
Begin
  Seconds := 150;
  Timer1.Enabled := False;
  Label5.Caption := '02:30';
  flags := 10;
End;

Procedure TForm1.CheckBox1Change(Sender: TObject);
Begin
  If Label5.Visible = True Then
  Begin
    Label5.Visible := False;
  End
  Else
  Begin
    Label5.Visible := True;
  End;
  If Label6.Visible = True Then
    Label6.Visible := False
  Else
    Label6.Visible := True;
End;

Procedure TForm1.MenuItem10Click(Sender: TObject);
Begin
  Form2.ShowModal;
End;

Procedure TForm1.PaintBox1Paint(Sender: TObject);
Var
  Bitmap: TBitmap;
  rectangleHeight, rectangleWidth, i, j: Integer;
Begin
  Bitmap := TBitmap.Create;
  // Initializes the Bitmap Size
  Bitmap.Height := PaintBox1.Height;
  Bitmap.Width := PaintBox1.Width;
  //Draw the background in white
  Bitmap.Canvas.Pen.Color := clWhite; //Line Color
  Bitmap.Canvas.Brush.Color := clWhite; //Fill Color
  Bitmap.Canvas.Rectangle(0, 0, PaintBox1.Width, PaintBox1.Height);
  // Draws squares
  For i := 0 To 7 Do
  Begin
    For j := 0 To 7 Do
    Begin
      Bitmap.Canvas.Pen.Color := clBlack; //Line Color
      Bitmap.Canvas.Brush.Color := clGray; //Brush color
      rectangleHeight := 50;
      rectangleWidth := 50;
      Bitmap.Canvas.Rectangle(i * rectangleWidth + 1, j * rectangleHeight + 1,
        i * rectangleWidth + rectangleWidth - 1, j * rectangleHeight +
        rectangleHeight - 1);
      //Write some text, in this case an *
      //Define Font properties
      Bitmap.Canvas.Font.Name := 'Liberation Mono';
      Bitmap.Canvas.Font.Style := [fsBold];
      Bitmap.Canvas.Font.Size := 10;
      Bitmap.Canvas.Font.Color := clBlack;
      //Write the text
      Bitmap.Canvas.TextOut(i * rectangleWidth + rectangleWidth Div
        2, j * rectangleHeight + rectangleHeight Div 3, '*');
    End;
  End;
  PaintBox1.Canvas.Draw(0, 1, Bitmap);
  Bitmap.Free; //Free the memory used by the object Bitmap
End;

Procedure TForm1.Timer1Timer(Sender: TObject);
Var
  Min, Sec: String;
Begin
  If Seconds = 0 Then
  Begin
    Timer1.Enabled := False;
    ShowMessage('Time is up!');
  End
  Else
  Begin
    Dec(Seconds);
    Min := IntToStr(Seconds Div 60);
    Sec := IntToStr(Seconds Mod 60);
    If Length(Min) = 1 Then
      Min := '0' + Min;
    If Length(Sec) = 1 Then
      Sec := '0' + Sec;
    Label5.Caption := Min + ':' + Sec;
  End;
End;


End.
